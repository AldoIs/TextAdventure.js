# TextAdventure.js

TextAdventure.js is a text adventure engine that runs on [Node.js](http://nodejs.org/) and makes use of [Express](http://expressjs.com/). The project has four main components; a simple server, a retro command line inspired web interface known as the Terminal, the text adventure engine itself colloquially called the Console and finally the cartridges (games) which are made up of two JavaScript objects. Each of these components is further explained in their respective section below.

## Server

The sever is an extremely simple Node.js file. It fires up an instance of an Express server on port 3000 to which it serves the Terminal to. All AJAX requests made to it are quickly passed to the Console to be executed. Responses are then dispatched back to the terminal. To get TextAdventure up and running on port 3000 simply run the following command from the project's folder:

```
node server.js
```

## Terminal

The Terminal consists of a single HTML file, and single CSS file and two JavaScript files (one of which is jQuery in case you need to run TextAdventure.js without an Internet connection). The Terminal's main job is to send the user's input to the Server and then display the Server's response to the user. The terminal has a few other creature comforts build in. First, it sends a "dummy" AJAX call to the server when the page loads to get the list of cartridges without requiring the user to input anything. Secondly, it keeps a record of the users input that can be navigated via the UP and DOWN arrow keys. The terminal's CSS can easily be tweaked to your liking.

## Console

The Console takes the user input passed to it by the Server acts on it and then returns a string that ultimately displayed to the user. Upon receiving the the user input the first thing the Console does is run it through the Parser to convert it to a more easy to use JavaScript object; consisting of an action, a subject and an object. The Console then runs the appropriate functionality based on the following hierarchy:

1. Does the action have a corresponding function in the cartridge
2. Does the action have a corresponding function in the console
3. Does the subject have a corresponding interaction

Following the executions of the appropriate functionality the updateLocation() function of the player's current location is run. If that function returns a string that string will be passed to the user in lieu of the string generated by the appropriate functionality.

The console implements the following player commands: "DROP", "GO", "INVENTORY", "LOAD", "LOOK", and "TAKE". Each is detailed below.

### DROP Command

DROP checks to see if the player has an item in their inventory that matches the command's subject. If so the item is removed from the players inventory and is added to the player's current location's items. A confirmation message or a failure message is the passed back to the user.

### GO Command

GO checks to see if the command's subject matches one of the rooms exits. If it does the player's current location's teardown() function is run followed by the destination locations setup() function. The players current location is then updated to the destination location. The new player's current location's description is returned if this is the first time the player has visited this location, otherwise the locations room is returned. A failure message is displayed if the user fails to provide a subject that matches an exit.

### INVENTORY Command

INVENTORY returns a enumerated list of all the items contained in the player's inventory.

### LOAD Command

LOAD will only run if the player is not currently playing a game. Similarly LOAD is the only command a player can execute if they are not currently playing a game. LOAD copies the content of the cartridge file that matches the subject into the list of active games maintained by the Console and assigns it to the user.

### LOOK Command

LOOK will return the player's current room's description if not subject is passed to it. If a subject is passed to it LOOK instead attempts to return the description of the item in the player's inventory matching the description. Failing that, LOOK attempts to return the description of the matching item in the player's current room. Finally, if that fails it attempts to return the look interaction of matching interactable in the player's current room. 

### TAKE Command

TAKE checks to see if the player's current location has an item that matched the command's subject. If so the item is removed from the player's current location's list of items and is added to the player's inventory. A confirmation message or a failure message is the passed back to the user.

### USE Command

Use will run the use() function of item in the player's inventory that matches the command's subject.

## Cartridges